# 悬浮标签列表功能测试指南

## 测试步骤

### 1. 准备工作
- 确保开发服务器正在运行 (`npm run dev`)
- 在Orca中打开插件
- 打开浏览器开发者工具的控制台，查看调试信息

### 2. 创建切换历史
1. **创建多个标签**：
   - 点击几个不同的块来创建标签
   - 确保有至少3-4个标签

2. **进行标签切换**：
   - 在标签之间切换几次
   - 例如：标签A → 标签B → 标签C → 标签A
   - 这样会创建切换历史记录

### 3. 测试悬浮功能
1. **鼠标悬停**：
   - 将鼠标悬停在任意标签上
   - 等待300ms（应该会看到控制台日志）
   - 观察是否出现悬浮列表

2. **查看控制台日志**：
   - 应该看到类似这样的日志：
   ```
   🖱️ 鼠标进入标签: 标签名称 (ID: xxx)
   ⏰ 开始检查标签 标签名称 的切换历史
   📋 标签 标签名称 的切换历史: X 个记录
   📍 计算悬浮位置: x=xxx, y=xxx
   📊 标签尺寸: width=xxx, height=xxx
   🎨 开始创建悬浮标签列表
   🏗️ 创建新容器
   📦 容器创建完成
   📄 容器已添加到页面
   🔄 更新内容
   ✅ 内容更新完成
   ✅ 悬浮标签列表创建完成
   ```

### 4. 测试交互功能
1. **点击切换**：
   - 点击悬浮列表中的任意标签
   - 应该切换到该标签并隐藏悬浮列表

2. **滚动功能**（如果有超过5个历史记录）：
   - 使用鼠标滚轮滚动
   - 使用键盘上下箭头键

### 5. 故障排除

#### 如果没有显示悬浮列表：
1. **检查控制台日志**：
   - 查看是否有错误信息
   - 确认鼠标悬停事件是否触发

2. **检查切换历史**：
   - 确认是否有切换历史记录
   - 如果没有，先进行几次标签切换

3. **检查DOM元素**：
   - 在开发者工具中搜索 `.hover-tab-list-container`
   - 确认元素是否被创建

#### 如果出现JavaScript错误：
1. **检查类型错误**：
   - 确认所有 `closest` 调用都使用了安全检查
   - 查看是否有其他类型相关错误

2. **检查事件绑定**：
   - 确认 `addHoverTabListEvents` 方法被正确调用
   - 检查事件监听器是否正确绑定

### 6. 预期行为

#### 正常情况：
- 鼠标悬停300ms后显示悬浮列表
- 悬浮列表显示在标签下方
- 标签按时间倒序排列（最新的在前）
- 标签大小和透明度渐变效果
- 点击标签可以切换
- 鼠标离开200ms后自动隐藏

#### 异常情况：
- 没有切换历史的标签不显示悬浮列表
- 快速移动鼠标不会频繁显示/隐藏
- 悬浮列表不会超出屏幕边界

## 调试技巧

### 1. 启用详细日志
在控制台中运行：
```javascript
window.DEBUG_ORCA_TABS = true;
```

### 2. 手动测试存储
在控制台中运行：
```javascript
// 查看存储的切换历史
orca.plugins.getData('orca-tabs-plugin', 'recent-tab-switch-history').then(console.log);
```

### 3. 检查DOM结构
在开发者工具中搜索：
- `.hover-tab-list-container` - 悬浮列表容器
- `.hover-tab-list-scroll` - 滚动容器
- `.hover-tab-item` - 单个标签项

## 常见问题

### Q: 为什么没有显示悬浮列表？
A: 可能的原因：
1. 标签没有切换历史
2. 鼠标悬停时间不够（需要300ms）
3. JavaScript错误阻止了功能执行

### Q: 悬浮列表显示位置不对？
A: 检查：
1. 标签元素的位置计算
2. 页面滚动位置
3. 容器定位样式

### Q: 点击无效？
A: 检查：
1. 事件冒泡是否被阻止
2. 点击目标是否正确
3. 标签切换逻辑是否正常
